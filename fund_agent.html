<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>智舵 - 小舵</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link href="https://at.alicdn.com/t/c/font_4431638_cpv7nz8taf4.css" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'AlibabaPuHuiTi';
            src: url('https://puhuiti.oss-cn-hangzhou.aliyuncs.com/AlibabaPuHuiTi-3/AlibabaPuHuiTi-3-55-Regular/AlibabaPuHuiTi-3-55-Regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'AlibabaPuHuiTi';
            src: url('https://puhuiti.oss-cn-hangzhou.aliyuncs.com/AlibabaPuHuiTi-3/AlibabaPuHuiTi-3-65-Medium/AlibabaPuHuiTi-3-65-Medium.woff2') format('woff2');
            font-weight: 500;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'AlibabaPuHuiTi';
            src: url('https://puhuiti.oss-cn-hangzhou.aliyuncs.com/AlibabaPuHuiTi-3/AlibabaPuHuiTi-3-75-SemiBold/AlibabaPuHuiTi-3-75-SemiBold.woff2') format('woff2');
            font-weight: 600;
            font-style: normal;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'AlibabaPuHuiTi', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: #f8f9fc;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        
        .ios-container {
            width: 100%;
            height: 100%;
            max-width: 430px;
            margin: 0 auto;
            background-color: #f8f9fc;
            border-radius: 40px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
        }
        
        .status-bar {
            height: 44px;
            background-color: #f8f9fc;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            color: #000;
            font-weight: 600;
        }
        
        .status-bar .time {
            flex: 1;
            text-align: center;
        }
        
        .status-bar .icons {
            display: flex;
            align-items: center;
        }
        
        .status-bar .icon {
            margin-left: 6px;
        }
        
        .chat-header {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            background-color: #ffffff;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
        }
        
        .chat-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .back-btn, .more-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .back-btn i, .more-btn i {
            font-size: 24px;
            color: #666;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            background-color: #f8f9fc;
        }
        
        .message-day {
            text-align: center;
            font-size: 12px;
            color: #999;
            margin: 8px 0 16px;
            position: relative;
        }
        
        .message-day:before, .message-day:after {
            content: "";
            height: 1px;
            background-color: #f0f0f0;
            flex: 1;
            position: absolute;
            top: 50%;
            width: 30%;
        }
        
        .message-day:before {
            left: 0;
        }
        
        .message-day:after {
            right: 0;
        }
        
        .message {
            max-width: 80%;
            margin-bottom: 16px;
            position: relative;
            align-self: flex-start;
        }
        
        .message.system {
            align-self: flex-start;
        }
        
        .message.user {
            align-self: flex-end;
        }
        
        .message-content {
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 15px;
            line-height: 1.5;
            position: relative;
        }
        
        .system .message-content {
            background-color: #ffffff;
            color: #333;
            border-top-left-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .user .message-content {
            background-color: #1a73e8;
            color: white;
            border-top-right-radius: 4px;
            box-shadow: 0 2px 8px rgba(26, 115, 232, 0.1);
        }
        
        .chat-input-container {
            padding: 10px 16px 30px;
            background-color: #ffffff;
            border-top: 1px solid #f0f0f0;
        }
        
        .function-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
            padding: 0 4px;
        }
        
        .scene-switcher {
            display: flex;
            align-items: center;
            background-color: #f5f7fa;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .network-toggle {
            display: flex;
            align-items: center;
            background-color: #f0f5ff;
            border-radius: 20px;
            padding: 6px 14px;
            font-size: 14px;
            cursor: pointer;
            color: #1a73e8;
            margin-left: 0;
            margin-right: auto;
        }
        
        .network-toggle i {
            font-size: 18px;
            margin-right: 4px;
            color: #1a73e8;
        }
        
        .scene-switcher i, .network-toggle i {
            font-size: 16px;
            margin-right: 4px;
            color: #666;
        }
        
        .scene-switcher .ri-arrow-down-s-line {
            margin-left: 4px;
            margin-right: 0;
        }
        
        .scene-switcher:hover, .network-toggle:hover {
            background-color: #e9ecf1;
        }
        
        .network-toggle.active {
            background-color: #e8f1ff;
            color: #1a73e8;
        }
        
        .network-toggle.active i {
            color: #1a73e8;
        }
        
        .chat-input {
            display: flex;
            align-items: center;
            background-color: #f5f7fa;
            border-radius: 30px;
            padding: 10px 16px;
        }
        
        .input-area {
            flex: 1;
            font-size: 15px;
            background: none;
            border: none;
            outline: none;
            color: #333;
            height: 24px;
            margin: 0 8px;
        }
        
        .input-tools {
            display: flex;
            align-items: center;
        }
        
        .tool-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 4px;
            cursor: pointer;
        }
        
        .tool-btn i {
            font-size: 20px;
            color: #666;
        }
        
        .plus-btn i {
            font-size: 22px;
            color: #1a73e8;
        }
        
        .camera-btn {
            margin-right: 4px;
        }
        
        .camera-btn i {
            color: #666;
            font-size: 20px;
        }
        
        /* 扩展菜单样式 */
        .extended-menu {
            display: none;
            justify-content: space-around;
            padding: 16px 0 8px 0;
            background-color: #f5f7fa;
            border-radius: 16px;
            margin-top: 12px;
        }
        
        .extended-menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 70px;
        }
        
        .menu-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }
        
        .menu-icon i {
            font-size: 24px;
            color: #1a73e8;
        }
        
        .menu-text {
            font-size: 12px;
            color: #666;
        }
        
        /* 适配底部安全区域 */
        @supports (padding-bottom: env(safe-area-inset-bottom)) {
            .chat-input-container {
                padding-bottom: calc(10px + env(safe-area-inset-bottom));
            }
        }
        
        /* 右上角菜单样式 */
        .more-menu {
            position: absolute;
            top: 60px;
            right: 16px;
            width: 240px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            z-index: 100;
            overflow: hidden;
            display: none;
        }
        
        .new-chat-btn {
            display: flex;
            align-items: center;
            padding: 15px 16px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            margin-top: 8px;
        }
        
        .new-chat-btn i {
            font-size: 20px;
            color: #1a73e8;
            margin-right: 10px;
        }
        
        .new-chat-btn .btn-text {
            font-size: 14px;
            color: #1a73e8;
            font-weight: 500;
        }
        
        .history-header {
            padding: 12px 16px;
            font-size: 13px;
            color: #666;
            background-color: #f8f9fc;
        }
        
        .history-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .history-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-item i {
            font-size: 18px;
            color: #666;
            margin-right: 10px;
        }
        
        .history-content {
            flex: 1;
        }
        
        .history-title {
            font-size: 14px;
            color: #333;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .history-time {
            font-size: 12px;
            color: #999;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.1);
            z-index: 99;
            display: none;
        }
        
        /* Scene dropdown menu */
        .scene-dropdown {
            position: absolute;
            bottom: 65px;
            left: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: 130px;
            overflow: hidden;
            z-index: 999;
            display: none;
        }
        
        .scene-option {
            padding: 12px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .scene-option:hover, .scene-option.active {
            background-color: #f5f7fa;
        }
        
        /* 添加旋转动画 */
        .rotating {
            animation: rotate 2s linear infinite;
        }
        
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="ios-container">
        <div class="status-bar">
            <div class="time">9:41</div>
            <div class="icons">
                <div class="icon">
                    <i class="ri-signal-wifi-fill"></i>
                </div>
                <div class="icon">
                    <i class="ri-battery-fill"></i>
                </div>
            </div>
        </div>
        
        <div class="chat-header">
            <div class="back-btn">
                <i class="ri-close-line"></i>
            </div>
            <div class="chat-title">小舵</div>
            <div class="more-btn">
                <i class="ri-more-2-fill"></i>
            </div>
        </div>
        
        <!-- 右上角菜单 -->
        <div class="more-menu">
            <div class="new-chat-btn">
                <i class="ri-add-circle-line"></i>
                <div class="btn-text">开启新会话</div>
            </div>
            <div class="history-header">历史聊天记录</div>
            <div class="history-list">
                <div class="history-item">
                    <i class="ri-chat-1-line"></i>
                    <div class="history-content">
                        <div class="history-title">Q3营收分析与预测报告</div>
                        <div class="history-time">今天 10:25</div>
                    </div>
                </div>
                <div class="history-item">
                    <i class="ri-chat-1-line"></i>
                    <div class="history-content">
                        <div class="history-title">成本控制优化方案制定</div>
                        <div class="history-time">今天 09:18</div>
                    </div>
                </div>
                <div class="history-item">
                    <i class="ri-chat-1-line"></i>
                    <div class="history-content">
                        <div class="history-title">现金流管理策略调整</div>
                        <div class="history-time">昨天 15:42</div>
                    </div>
                </div>
                <div class="history-item">
                    <i class="ri-chat-1-line"></i>
                    <div class="history-content">
                        <div class="history-title">投资回报率分析</div>
                        <div class="history-time">昨天 11:30</div>
                    </div>
                </div>
                <div class="history-item">
                    <i class="ri-chat-1-line"></i>
                    <div class="history-content">
                        <div class="history-title">市场拓展预算规划</div>
                        <div class="history-time">06-15 14:20</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="overlay"></div>
        
        <div class="chat-messages">
            <div class="message-day">今天</div>
            <div class="message system">
                <div class="message-content">
                    <p>欢迎使用经营决策智能体，您可以随时获取实时经营数据，进行深度分析，并获得智能化的经营决策建议与风险预警。</p>
                    
                    <div style="margin-top: 10px; background: #f8f9fc; border-radius: 12px; padding: 12px;">
                        <div style="margin-bottom: 8px; font-weight: 500; color: #333;">您可以体验以下场景：</div>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <div id="data-scenario" style="background: #E8F1FF; color: #1a73e8; padding: 10px 12px; border-radius: 12px; font-size: 14px; cursor: pointer;">一、经营数据获取模拟</div>
                            <div id="decision-scenario" style="background: #E8F1FF; color: #1a73e8; padding: 10px 12px; border-radius: 12px; font-size: 14px; cursor: pointer;">二、经营决策制定</div>
                        </div>
                    </div>
                    
                    <p style="margin-top: 8px; font-size: 13px; color: red;">以上经营场景仅作为产品演示，真正上线后CEO在输入框直接输入提示词查询经营数据或制定决策。</p>
                </div>
            </div>
        </div>
        
        <div class="chat-input-container">
            <div class="function-bar">
                <div class="scene-switcher">
                    <i class="iconfont icon-quanjing"></i>
                    <span>经营决策</span>
                    <i class="ri-arrow-down-s-line"></i>
                </div>
                <div class="network-toggle active">
                    <i class="ri-global-line"></i>
                    <span>联网</span>
                </div>
            </div>
            <div class="chat-input">
                <div class="tool-btn camera-btn">
                    <i class="ri-camera-line"></i>
                </div>
                <input type="text" class="input-area" placeholder="请输入公司经营类问题～" autofocus>
                <div class="input-tools">
                    <div class="tool-btn">
                        <i class="ri-mic-line"></i>
                    </div>
                    <div class="tool-btn plus-btn">
                        <i class="ri-add-line"></i>
                    </div>
                </div>
            </div>
            
            <!-- 添加扩展菜单，默认隐藏 -->
            <div class="extended-menu">
                <div class="extended-menu-item">
                    <div class="menu-icon">
                        <i class="ri-camera-line"></i>
                    </div>
                    <div class="menu-text">拍照</div>
                </div>
                <div class="extended-menu-item">
                    <div class="menu-icon">
                        <i class="ri-image-line"></i>
                    </div>
                    <div class="menu-text">上传照片</div>
                </div>
                <div class="extended-menu-item">
                    <div class="menu-icon">
                        <i class="ri-file-line"></i>
                    </div>
                    <div class="menu-text">上传文件</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // 页面加载完成后自动聚焦输入框
        window.onload = function() {
            document.querySelector('.input-area').focus();
            addBusinessExample();
        };
        
        // 返回按钮功能 - 修改为返回上一页
        const backBtn = document.querySelector('.back-btn');
        backBtn.addEventListener('click', function() {
            window.history.back();
        });
        
        // 处理"+"按钮点击事件
        const plusBtn = document.querySelector('.plus-btn');
        const extendedMenu = document.querySelector('.extended-menu');
        let plusMenuVisible = false;
        
        plusBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            if (plusMenuVisible) {
                extendedMenu.style.display = 'none';
            } else {
                extendedMenu.style.display = 'flex';
            }
            plusMenuVisible = !plusMenuVisible;
        });
        
        // 点击其他区域关闭扩展菜单
        document.addEventListener('click', function(e) {
            if (!plusBtn.contains(e.target) && !extendedMenu.contains(e.target) && plusMenuVisible) {
                extendedMenu.style.display = 'none';
                plusMenuVisible = false;
            }
        });
        
        // 处理相机按钮点击事件
        const cameraBtn = document.querySelector('.camera-btn');
        cameraBtn.addEventListener('click', function() {
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                alert('正在打开相机...');
            } else {
                alert('您的设备不支持相机功能');
            }
        });
        
        // 实现消息发送功能
        function sendMessage() {
            const inputArea = document.querySelector('.input-area');
            const text = inputArea.value.trim();
            if (!text) return;
            
            // 创建用户消息
            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.innerHTML = '<div class="message-content">' + text + '</div>';
            
            // 添加到消息列表
            const chatMessages = document.querySelector('.chat-messages');
            chatMessages.appendChild(userMsg);
            
            // 清空输入框
            inputArea.value = '';
            
            // 滚动到底部
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // 模拟小舵回复
            setTimeout(() => {
                // 显示正在输入
                const typingMsg = document.createElement('div');
                typingMsg.className = 'message system typing';
                typingMsg.innerHTML = '<div class="message-content">小舵正在思考...</div>';
                chatMessages.appendChild(typingMsg);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // 模拟回复延迟
                setTimeout(() => {
                    // 移除"正在输入"提示
                    chatMessages.removeChild(typingMsg);
                    
                    // 无论用户输入什么，总是显示欢迎语和演示场景
                    const systemMsg = document.createElement('div');
                    systemMsg.className = 'message system';
                    systemMsg.innerHTML = '<div class="message-content"><p>欢迎使用经营决策智能体，您可以随时获取实时经营数据，进行深度分析，并获得智能化的经营决策建议与风险预警。</p><div style="margin-top: 10px; background: #f8f9fc; border-radius: 12px; padding: 12px;"><div style="margin-bottom: 8px; font-weight: 500; color: #333;">您可以体验以下场景：</div><div style="display: flex; flex-direction: column; gap: 10px;"><div id="data-scenario-response" style="background: #E8F1FF; color: #1a73e8; padding: 10px 12px; border-radius: 12px; font-size: 14px; cursor: pointer;">一、经营数据获取模拟</div><div id="decision-scenario-response" style="background: #E8F1FF; color: #1a73e8; padding: 10px 12px; border-radius: 12px; font-size: 14px; cursor: pointer;">二、经营决策制定</div></div></div><p style="margin-top: 8px; font-size: 13px; color: red;">以上经营场景仅作为产品演示，真正上线后CEO在输入框直接输入提示词查询经营数据或制定决策。</p></div>';
                    chatMessages.appendChild(systemMsg);
                    
                    // 滚动到底部
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // 给新生成的按钮添加事件监听
                    setTimeout(() => {
                        const dataScenarioResponse = document.getElementById('data-scenario-response');
                        const decisionScenarioResponse = document.getElementById('decision-scenario-response');
                        
                        if (dataScenarioResponse) {
                            dataScenarioResponse.addEventListener('click', startDataScenario);
                        }
                        
                        if (decisionScenarioResponse) {
                            decisionScenarioResponse.addEventListener('click', startDecisionScenario);
                        }
                    }, 100);
                    
                }, 1500);
            }, 500);
        }
        
        // 监听输入框回车事件
        document.querySelector('.input-area').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // 处理右上角更多按钮点击事件
        const moreBtn = document.querySelector('.more-btn');
        const moreMenu = document.querySelector('.more-menu');
        const overlay = document.querySelector('.overlay');
        let moreMenuVisible = false;
        
        // 点击遮罩层关闭菜单
        overlay.addEventListener('click', function() {
            moreMenu.style.display = 'none';
            overlay.style.display = 'none';
            moreMenuVisible = false;
        });
        
        // 处理开启新会话按钮点击事件
        const newChatBtn = document.querySelector('.new-chat-btn');
        newChatBtn.addEventListener('click', function() {
            // 清空聊天消息
            const chatMessages = document.querySelector('.chat-messages');
            chatMessages.innerHTML = '<div class="message-day">今天</div><div class="message system"><div class="message-content">欢迎使用经营决策智能体，您可以随时获取实时经营数据，进行深度分析，并获得智能化的经营决策建议与风险预警。</div></div>';
            
            // 关闭菜单
            moreMenu.style.display = 'none';
            overlay.style.display = 'none';
            moreMenuVisible = false;
        });
        
        // 处理历史记录点击事件
        const historyItems = document.querySelectorAll('.history-item');
        historyItems.forEach(item => {
            item.addEventListener('click', function() {
                const historyTitle = this.querySelector('.history-title').textContent;
                
                // 加载相应的历史记录
                const chatMessages = document.querySelector('.chat-messages');
                
                // 根据标题加载不同的历史记录
                if (historyTitle.includes('营收')) {
                    chatMessages.innerHTML = '<div class="message-day">今天</div><div class="message user"><div class="message-content">我想看看Q3季度的营收情况和预测</div></div><div class="message system"><div class="message-content">根据最新数据分析，Q3季度营收表现良好。当前实际营收2.1亿元，同比增长13.5%，预计季度末将达到2.3亿元。主要增长来源是B端客户续约率提升和新客户拓展成效显著。</div></div>';
                } else if (historyTitle.includes('成本')) {
                    chatMessages.innerHTML = '<div class="message-day">今天</div><div class="message user"><div class="message-content">成本控制方面有什么优化建议？</div></div><div class="message system"><div class="message-content">通过数据分析发现三个优化机会：1）技术研发成本占比过高，建议优化人员配置；2）市场推广ROI可提升15%；3）运营成本中办公场地费用有压缩空间。预计整体可降低成本8-12%。</div></div>';
                } else if (historyTitle.includes('现金流')) {
                    chatMessages.innerHTML = '<div class="message-day">昨天</div><div class="message user"><div class="message-content">现金流管理需要注意什么？</div></div><div class="message system"><div class="message-content">当前现金流状况总体健康，但需关注：1）应收账款回收周期略长，建议加强催收；2）Q4有大额设备采购计划，需提前安排资金；3）建议保持1.5个月运营资金储备。</div></div>';
                } else if (historyTitle.includes('投资回报')) {
                    chatMessages.innerHTML = '<div class="message-day">昨天</div><div class="message user"><div class="message-content">各项投资的回报率如何？</div></div><div class="message system"><div class="message-content">技术研发投资ROI达到245%，市场推广ROI为180%，人员培训投资回报156%。建议继续加大技术研发投入，优化市场推广策略，人员培训投资保持现有水平。</div></div>';
                } else if (historyTitle.includes('预算')) {
                    chatMessages.innerHTML = '<div class="message-day">6月15日</div><div class="message user"><div class="message-content">下半年市场拓展预算怎么分配？</div></div><div class="message system"><div class="message-content">建议总预算800万元，其中：线上推广40%（320万），线下活动30%（240万），渠道合作20%（160万），品牌建设10%（80万）。重点投入华东和华南市场，预期新增客户120家。</div></div>';
                }
                
                // 关闭菜单
                moreMenu.style.display = 'none';
                overlay.style.display = 'none';
                moreMenuVisible = false;
                
                // 滚动到底部
                chatMessages.scrollTop = chatMessages.scrollHeight;
            });
        });
        
        // 添加经营决策示例
        function addBusinessExample() {
            const chatMessages = document.querySelector('.chat-messages');
            
            // Clear current messages
            chatMessages.innerHTML = '<div class="message-day">今天</div>';
            
            // Add welcome message
            addSystemMessage('<p>欢迎使用经营决策智能体，您可以随时获取实时经营数据，进行深度分析，并获得智能化的经营决策建议与风险预警。</p><div style="margin-top: 10px; background: #f8f9fc; border-radius: 12px; padding: 12px;"><div style="margin-bottom: 8px; font-weight: 500; color: #333;">您可以体验以下场景：</div><div style="display: flex; flex-direction: column; gap: 10px;"><div id="data-scenario" style="background: #E8F1FF; color: #1a73e8; padding: 10px 12px; border-radius: 12px; font-size: 14px; cursor: pointer;">一、经营数据获取模拟</div><div id="decision-scenario" style="background: #E8F1FF; color: #1a73e8; padding: 10px 12px; border-radius: 12px; font-size: 14px; cursor: pointer;">二、经营决策制定</div></div></div><p style="margin-top: 8px; font-size: 13px; color: red;">以上经营场景仅作为产品演示，真正上线后CEO在输入框直接输入提示词查询经营数据或制定决策。</p>');
            
            // Add click event listeners to scenario buttons after they are created
            setTimeout(() => {
                const dataScenario = document.getElementById('data-scenario');
                const decisionScenario = document.getElementById('decision-scenario');
                
                if (dataScenario) {
                    dataScenario.addEventListener('click', startDataScenario);
                }
                
                if (decisionScenario) {
                    decisionScenario.addEventListener('click', startDecisionScenario);
                }
            }, 100);
        }
        
        // 经营数据获取场景模拟 - 修改这个函数
        function startDataScenario() {
            const chatMessages = document.querySelector('.chat-messages');
            
            addSystemMessage('您已选择：<strong>经营数据获取模拟</strong>');
            addSystemMessage('请输入您想查询的经营数据');
            
            document.querySelector('.input-area').focus();
            
            setTimeout(() => {
                addUserMessage('查询今日资金流向和现金流状况');
                
                setTimeout(() => {
                    const systemMsg = document.createElement('div');
                    systemMsg.className = 'message system';
                    systemMsg.innerHTML = '<div class="message-content"><p><strong>今日资金流向分析报告</strong>：</p><div style="margin-top: 12px; background: #f8f9fc; border-radius: 12px; padding: 16px;"><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 12px;">📊 核心指标概览</div><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;"><div style="background: #fff; border-radius: 8px; padding: 12px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 3px solid #34C759;"><div style="font-size: 18px; font-weight: 600; color: #34C759;">27万</div><div style="font-size: 12px; color: #666; margin-top: 4px;">资金流入</div></div><div style="background: #fff; border-radius: 8px; padding: 12px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 3px solid #FF3B30;"><div style="font-size: 18px; font-weight: 600; color: #FF3B30;">68万</div><div style="font-size: 12px; color: #666; margin-top: 4px;">资金流出</div></div><div style="background: #fff; border-radius: 8px; padding: 12px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 3px solid #007AFF;"><div style="font-size: 18px; font-weight: 600; color: #007AFF;">1,600万</div><div style="font-size: 12px; color: #666; margin-top: 4px;">现金余额</div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px;">📈 资金流向结构分析</div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="margin-bottom: 12px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;"><div style="font-weight: 500; margin-bottom: 6px; color: #34C759;">资金流入构成（27万元）</div><div style="display: flex; align-items: center; margin-bottom: 4px;"><div style="width: 80px; font-size: 13px;">销售回款</div><div style="flex: 1; height: 6px; background: #f1f1f1; border-radius: 3px; margin: 0 10px; overflow: hidden;"><div style="width: 81.5%; height: 100%; background: #34C759;"></div></div><div style="font-size: 13px; font-weight: 500;">22万</div></div><div style="display: flex; align-items: center;"><div style="width: 80px; font-size: 13px;">其他收款</div><div style="flex: 1; height: 6px; background: #f1f1f1; border-radius: 3px; margin: 0 10px; overflow: hidden;"><div style="width: 18.5%; height: 100%; background: #34C759;"></div></div><div style="font-size: 13px; font-weight: 500;">5万</div></div></div><div><div style="font-weight: 500; margin-bottom: 6px; color: #FF3B30;">资金流出构成（68万元）</div><div style="display: flex; align-items: center; margin-bottom: 4px;"><div style="width: 80px; font-size: 13px;">材料采购</div><div style="flex: 1; height: 6px; background: #f1f1f1; border-radius: 3px; margin: 0 10px; overflow: hidden;"><div style="width: 64.7%; height: 100%; background: #FF3B30;"></div></div><div style="font-size: 13px; font-weight: 500;">44万</div></div><div style="display: flex; align-items: center; margin-bottom: 4px;"><div style="width: 80px; font-size: 13px;">代收代付</div><div style="flex: 1; height: 6px; background: #f1f1f1; border-radius: 3px; margin: 0 10px; overflow: hidden;"><div style="width: 17.6%; height: 100%; background: #FF3B30;"></div></div><div style="font-size: 13px; font-weight: 500;">12万</div></div><div style="display: flex; align-items: center; margin-bottom: 4px;"><div style="width: 80px; font-size: 13px;">税费支出</div><div style="flex: 1; height: 6px; background: #f1f1f1; border-radius: 3px; margin: 0 10px; overflow: hidden;"><div style="width: 10.3%; height: 100%; background: #FF3B30;"></div></div><div style="font-size: 13px; font-weight: 500;">7万</div></div><div style="display: flex; align-items: center;"><div style="width: 80px; font-size: 13px;">其他支出</div><div style="flex: 1; height: 6px; background: #f1f1f1; border-radius: 3px; margin: 0 10px; overflow: hidden;"><div style="width: 7.4%; height: 100%; background: #FF3B30;"></div></div><div style="font-size: 13px; font-weight: 500;">5万</div></div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px;">📋 各业务单元资金状况</div><div style="background: #fff; border-radius: 8px; padding: 12px;"><table style="width: 100%; font-size: 12px;"><tr style="background: #f8f9fc;"><th style="padding: 6px; text-align: left;">业务单元</th><th style="padding: 6px; text-align: right;">现金余额</th><th style="padding: 6px; text-align: right;">可用资金</th><th style="padding: 6px; text-align: center;">状态</th></tr><tr><td style="padding: 6px; font-weight: 500;">华科电子</td><td style="padding: 6px; text-align: right;">777万</td><td style="padding: 6px; text-align: right;">168万</td><td style="padding: 6px; text-align: center;"><span style="background: #e8f5e9; color: #27ae60; padding: 2px 6px; border-radius: 4px; font-size: 10px;">健康</span></td></tr><tr><td style="padding: 6px; font-weight: 500;">猎豹交通</td><td style="padding: 6px; text-align: right;">390万</td><td style="padding: 6px; text-align: right;">0万</td><td style="padding: 6px; text-align: center;"><span style="background: #fff3e0; color: #e67e22; padding: 2px 6px; border-radius: 4px; font-size: 10px;">紧张</span></td></tr><tr><td style="padding: 6px; font-weight: 500;">产业园区</td><td style="padding: 6px; text-align: right;">187万</td><td style="padding: 6px; text-align: right;">87万</td><td style="padding: 6px; text-align: center;"><span style="background: #e8f5e9; color: #27ae60; padding: 2px 6px; border-radius: 4px; font-size: 10px;">正常</span></td></tr><tr><td style="padding: 6px; font-weight: 500;">联合经营</td><td style="padding: 6px; text-align: right;">99万</td><td style="padding: 6px; text-align: right;">2万</td><td style="padding: 6px; text-align: center;"><span style="background: #ffebee; color: #e74c3c; padding: 2px 6px; border-radius: 4px; font-size: 10px;">预警</span></td></tr></table></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #e67e22; margin-bottom: 8px;">⚠️ 风险预警</div><div style="background: #fff3e0; border-radius: 8px; padding: 12px;"><div style="display: flex; align-items: center; margin-bottom: 8px;"><i class="ri-error-warning-line" style="color: #e67e22; font-size: 16px; margin-right: 8px;"></i><div style="font-size: 13px; font-weight: 500;">资金流出超过流入41万元，需关注现金流压力</div></div><div style="display: flex; align-items: center; margin-bottom: 8px;"><i class="ri-error-warning-line" style="color: #e67e22; font-size: 16px; margin-right: 8px;"></i><div style="font-size: 13px; font-weight: 500;">猎豹交通可用资金为0，存在流动性风险</div></div><div style="display: flex; align-items: center;"><i class="ri-error-warning-line" style="color: #e67e22; font-size: 16px; margin-right: 8px;"></i><div style="font-size: 13px; font-weight: 500;">材料采购支出占比过高（64.7%），需优化供应链成本</div></div></div></div><div><div style="font-weight: 500; color: #27ae60; margin-bottom: 8px;">💡 建议措施</div><div style="background: #e8f5e9; border-radius: 8px; padding: 12px;"><div style="margin-bottom: 8px;"><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">短期措施（1-2周内）</div><div style="font-size: 13px; color: #666;">1. 加强销售回款催收，重点关注大客户回款时间</div><div style="font-size: 13px; color: #666;">2. 暂缓非必要的材料采购，优化库存管理</div><div style="font-size: 13px; color: #666;">3. 为猎豹交通调配20-30万流动资金</div></div><div><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">中期措施（1个月内）</div><div style="font-size: 13px; color: #666;">1. 建立各BG间资金调配机制，提高资金使用效率</div><div style="font-size: 13px; color: #666;">2. 重新评估材料采购价格，寻找更优质供应商</div><div style="font-size: 13px; color: #666;">3. 制定各业务单元最低可用资金标准</div></div></div></div></div></div><p style="margin-top: 12px;">您还想了解其他方面的数据吗？比如年度累计对比或大额资金明细。</p></div>';
                    chatMessages.appendChild(systemMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000);
                
                setTimeout(() => {
                    addUserMessage('年度累计情况如何？与去年同期相比有什么变化？');
                    
                    setTimeout(() => {
                        const systemMsg = document.createElement('div');
                        systemMsg.className = 'message system';
                        systemMsg.innerHTML = '<div class="message-content"><p><strong>年度累计资金分析对比</strong>：</p><div style="margin-top: 12px; background: #f8f9fc; border-radius: 12px; padding: 16px;"><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px;">📊 年度累计数据对比（万元）</div><div style="background: #fff; border-radius: 8px; padding: 12px; margin-bottom: 12px;"><table style="width: 100%; font-size: 13px;"><tr style="background: #f8f9fc;"><th style="padding: 8px; text-align: left;">指标</th><th style="padding: 8px; text-align: right;">本年累计</th><th style="padding: 8px; text-align: right;">去年同期</th><th style="padding: 8px; text-align: right;">同比变化</th></tr><tr><td style="padding: 8px; font-weight: 500;">资金流入</td><td style="padding: 8px; text-align: right; color: #34C759; font-weight: 600;">47,000</td><td style="padding: 8px; text-align: right;">38,700</td><td style="padding: 8px; text-align: right; color: #34C759; font-weight: 500;">+21.4% ↗</td></tr><tr><td style="padding: 8px; font-weight: 500;">资金流出</td><td style="padding: 8px; text-align: right; color: #FF3B30; font-weight: 600;">46,000</td><td style="padding: 8px; text-align: right;">39,200</td><td style="padding: 8px; text-align: right; color: #FF3B30; font-weight: 500;">+17.3% ↗</td></tr><tr style="background: #f0f5ff;"><td style="padding: 8px; font-weight: 600;">净现金流</td><td style="padding: 8px; text-align: right; color: #007AFF; font-weight: 600;">+1,000</td><td style="padding: 8px; text-align: right;">-500</td><td style="padding: 8px; text-align: right; color: #34C759; font-weight: 600;">扭亏为盈 🎉</td></tr></table></div><div style="background: #e8f1ff; border-radius: 8px; padding: 12px;"><div style="font-weight: 500; margin-bottom: 6px; color: #1a73e8;">💹 年度趋势图表</div><div style="background: #fff; border-radius: 6px; padding: 8px; margin: 8px 0;"><div style="display: flex; justify-content: space-between; align-items: end; height: 80px; border-bottom: 1px solid #eee;"><div style="display: flex; flex-direction: column; align-items: center;"><div style="width: 20px; height: 47px; background: linear-gradient(to top, #FF9F43, #FFB976); border-radius: 2px; margin-bottom: 4px;"></div><div style="font-size: 10px; color: #666;">本年流入</div><div style="font-size: 10px; font-weight: 500;">47,000</div></div><div style="display: flex; flex-direction: column; align-items: center;"><div style="width: 20px; height: 39px; background: linear-gradient(to top, #5A8DEE, #7BA7F7); border-radius: 2px; margin-bottom: 4px;"></div><div style="font-size: 10px; color: #666;">去年流入</div><div style="font-size: 10px; font-weight: 500;">38,700</div></div><div style="display: flex; flex-direction: column; align-items: center;"><div style="width: 20px; height: 46px; background: linear-gradient(to top, #FF6B9D, #FF8FB3); border-radius: 2px; margin-bottom: 4px;"></div><div style="font-size: 10px; color: #666;">本年流出</div><div style="font-size: 10px; font-weight: 500;">46,000</div></div><div style="display: flex; flex-direction: column; align-items: center;"><div style="width: 20px; height: 39px; background: linear-gradient(to top, #C44569, #D8667A); border-radius: 2px; margin-bottom: 4px;"></div><div style="font-size: 10px; color: #666;">去年流出</div><div style="font-size: 10px; font-weight: 500;">39,200</div></div></div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px;">📈 关键变化分析</div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="margin-bottom: 12px;"><div style="font-weight: 500; margin-bottom: 6px; color: #34C759;">✅ 积极变化</div><div style="font-size: 13px; color: #333; margin-bottom: 4px;">• <strong>收入增长强劲</strong>：流入资金同比增长21.4%，说明业务拓展效果显著</div><div style="font-size: 13px; color: #333; margin-bottom: 4px;">• <strong>盈利能力提升</strong>：从去年同期亏损500万转为盈利1,000万</div><div style="font-size: 13px; color: #333;">• <strong>现金管理改善</strong>：流出增幅（17.3%）低于流入增幅（21.4%）</div></div><div><div style="font-weight: 500; margin-bottom: 6px; color: #e67e22;">⚠️ 需要关注</div><div style="font-size: 13px; color: #333; margin-bottom: 4px;">• <strong>支出增长较快</strong>：流出同比增长17.3%，需关注成本控制</div><div style="font-size: 13px; color: #333; margin-bottom: 4px;">• <strong>增长质量</strong>：需分析收入增长的可持续性和成本结构</div><div style="font-size: 13px; color: #333;">• <strong>季度波动</strong>：需关注各季度资金流的均衡性</div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px;">🎯 未来3个月预测</div><div style="background: #f0f5ff; border-radius: 8px; padding: 12px;"><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 12px;"><div style="text-align: center; background: #fff; border-radius: 6px; padding: 8px;"><div style="font-size: 11px; color: #666;">Q4预测流入</div><div style="font-size: 16px; font-weight: 600; color: #34C759;">15,000万</div></div><div style="text-align: center; background: #fff; border-radius: 6px; padding: 8px;"><div style="font-size: 11px; color: #666;">Q4预测流出</div><div style="font-size: 16px; font-weight: 600; color: #FF3B30;">14,200万</div></div><div style="text-align: center; background: #fff; border-radius: 6px; padding: 8px;"><div style="font-size: 11px; color: #666;">预期净流入</div><div style="font-size: 16px; font-weight: 600; color: #007AFF;">+800万</div></div></div><div style="font-size: 12px; color: #666; text-align: center;">基于历史数据和当前趋势预测，建议提前做好资金调配安排</div></div></div><div><div style="font-weight: 500; color: #27ae60; margin-bottom: 8px;">🚀 战略建议</div><div style="background: #e8f5e9; border-radius: 8px; padding: 12px;"><div style="margin-bottom: 8px;"><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">1. 收入端优化</div><div style="font-size: 13px; color: #666;">继续加大市场开拓力度，重点关注高利润业务，确保收入增长的可持续性</div></div><div style="margin-bottom: 8px;"><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">2. 成本端控制</div><div style="font-size: 13px; color: #666;">建立成本动态监控机制，重点控制材料采购和运营成本，目标控制流出增幅在15%以内</div></div><div><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">3. 资金端管理</div><div style="font-size: 13px; color: #666;">建立集团资金池管理机制，提高资金使用效率，为明年业务扩张做好资金储备</div></div></div></div></div></div><p style="margin-top: 12px;">数据显示公司经营状况良好，您是否需要了解具体的大额资金流向明细？</p></div>';
                    chatMessages.appendChild(systemMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1200);
            }, 3000);
            
            setTimeout(() => {
                addUserMessage('显示大额资金明细，特别是超过10万的单笔资金');
                
                setTimeout(() => {
                    const systemMsg = document.createElement('div');
                    systemMsg.className = 'message system';
                    systemMsg.innerHTML = '<div class="message-content"><p><strong>大额资金明细分析</strong>：</p><div style="margin-top: 12px; background: #f8f9fc; border-radius: 12px; padding: 16px;"><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px;">💰 10万以上资金流向明细</div><div style="background: #f0fff5; border-radius: 8px; padding: 12px; margin-bottom: 12px; border-left: 4px solid #34C759;"><div style="font-weight: 500; margin-bottom: 8px; color: #34C759; display: flex; align-items: center;"><i class="ri-arrow-down-circle-line" style="margin-right: 6px; font-size: 16px;"></i>大额资金流入</div><div style="background: #fff; border-radius: 6px; padding: 10px; margin-bottom: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;"><div style="font-weight: 500; font-size: 14px;">中国工商银行北京市分行</div><div style="font-size: 16px; font-weight: 600; color: #34C759;">372.19万元</div></div><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; font-size: 12px; color: #666;"><div><span style="color: #999;">收款单位:</span> 华科电子BG</div><div><span style="color: #999;">类别:</span> 销售回款</div><div><span style="color: #999;">经手人:</span> 于志国</div></div></div><div style="background: #fff; border-radius: 6px; padding: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;"><div style="font-weight: 500; font-size: 14px;">中国移动扬州分公司</div><div style="font-size: 16px; font-weight: 600; color: #34C759;">10.20万元</div></div><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; font-size: 12px; color: #666;"><div><span style="color: #999;">收款单位:</span> 华科电子BG</div><div><span style="color: #999;">类别:</span> 销售回款</div><div><span style="color: #999;">经手人:</span> 吕吉林</div></div></div></div><div style="background: #fff2f2; border-radius: 8px; padding: 12px; border-left: 4px solid #FF3B30;"><div style="font-weight: 500; margin-bottom: 8px; color: #FF3B30; display: flex; align-items: center;"><i class="ri-arrow-up-circle-line" style="margin-right: 6px; font-size: 16px;"></i>大额资金流出</div><div style="background: #fff; border-radius: 6px; padding: 10px; margin-bottom: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;"><div style="font-weight: 500; font-size: 14px;">归还银行贷款</div><div style="font-size: 16px; font-weight: 600; color: #FF3B30;">100.00万元</div></div><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; font-size: 12px; color: #666; margin-bottom: 8px;"><div><span style="color: #999;">付款单位:</span> 集团总部</div><div><span style="color: #999;">类别:</span> 偿还贷款</div><div><span style="color: #999;">经手人:</span> 杨成</div></div><div style="background: #f9f9fb; border-radius: 4px; padding: 6px; font-size: 12px; color: #666;"><span style="color: #999;">备注:</span> 按合同约定还款，滴发长期贷款</div></div><div style="background: #fff; border-radius: 6px; padding: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;"><div style="font-weight: 500; font-size: 14px;">支付贷款利息</div><div style="font-size: 16px; font-weight: 600; color: #FF3B30;">11.03万元</div></div><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; font-size: 12px; color: #666;"><div><span style="color: #999;">付款单位:</span> 集团总部</div><div><span style="color: #999;">类别:</span> 利息支出</div><div><span style="color: #999;">经手人:</span> 齐冬瑾</div></div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px;">📊 大额资金统计分析</div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 12px;"><div><div style="font-size: 12px; color: #666; margin-bottom: 4px;">大额流入占比</div><div style="display: flex; align-items: center;"><div style="font-size: 18px; font-weight: 600; color: #34C759; margin-right: 8px;">87.2%</div><div style="font-size: 11px; color: #666;">(382.39万/438万)</div></div><div style="height: 6px; background: #f1f1f1; border-radius: 3px; overflow: hidden; margin-top: 4px;"><div style="width: 87.2%; height: 100%; background: #34C759;"></div></div></div><div><div style="font-size: 12px; color: #666; margin-bottom: 4px;">大额流出占比</div><div style="display: flex; align-items: center;"><div style="font-size: 18px; font-weight: 600; color: #FF3B30; margin-right: 8px;">45.1%</div><div style="font-size: 11px; color: #666;">(111.03万/246万)</div></div><div style="height: 6px; background: #f1f1f1; border-radius: 3px; overflow: hidden; margin-top: 4px;"><div style="width: 45.1%; height: 100%; background: #FF3B30;"></div></div></div></div><div style="background: #f8f9fc; border-radius: 6px; padding: 8px;"><div style="font-size: 12px; color: #666; margin-bottom: 4px;">资金集中度分析：</div><div style="font-size: 13px; color: #333;">• 大额流入主要来源于华科电子BG，客户集中度较高</div><div style="font-size: 13px; color: #333;">• 大额流出主要为金融机构还款，资金成本控制良好</div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #e67e22; margin-bottom: 8px;">⚠️ 风险提示</div><div style="background: #fff3e0; border-radius: 8px; padding: 12px;"><div style="display: flex; align-items: center; margin-bottom: 6px;"><i class="ri-error-warning-line" style="color: #e67e22; font-size: 14px; margin-right: 6px;"></i><div style="font-size: 13px; font-weight: 500;">客户集中度风险</div></div><div style="font-size: 12px; color: #666; margin-bottom: 8px; padding-left: 20px;">华科电子BG承担了主要大额回款，需关注客户多元化</div><div style="display: flex; align-items: center; margin-bottom: 6px;"><i class="ri-error-warning-line" style="color: #e67e22; font-size: 14px; margin-right: 6px;"></i><div style="font-size: 13px; font-weight: 500;">债务偿还压力</div></div><div style="font-size: 12px; color: #666; padding-left: 20px;">本月偿还贷款100万，需确保后续月份有足够偿债能力</div></div></div><div><div style="font-weight: 500; color: #27ae60; margin-bottom: 8px;">💡 管理建议</div><div style="background: #e8f5e9; border-radius: 8px; padding: 12px;"><div style="margin-bottom: 8px;"><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">1. 客户管理优化</div><div style="font-size: 12px; color: #666;">• 加强与工商银行等大客户的长期合作关系维护</div><div style="font-size: 12px; color: #666;">• 开发更多优质客户，降低对单一客户的依赖度</div></div><div style="margin-bottom: 8px;"><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">2. 资金管控加强</div><div style="font-size: 12px; color: #666;">• 建立大额资金审批二级管控机制</div><div style="font-size: 12px; color: #666;">• 设置10万以上资金流动实时监控预警</div></div><div><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60;">3. 财务计划优化</div><div style="font-size: 12px; color: #666;">• 根据还款计划合理安排资金调配</div><div style="font-size: 12px; color: #666;">• 考虑通过应收账款保理等方式优化现金流</div></div></div></div></div></div><p style="margin-top: 12px;">大额资金分析完成。基于这些数据，您是否需要我制定具体的资金调配方案？</p></div>';
                    chatMessages.appendChild(systemMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1500);
            }, 5000);
        }, 1000);
    }
        
        // 经营决策制定场景模拟 - 修改这个函数
        function startDecisionScenario() {
            const chatMessages = document.querySelector('.chat-messages');
            
            addSystemMessage('您已选择：<strong>经营决策制定</strong>');
            addSystemMessage('经营决策智能体已启动，正在融合资金日报、经营月报、年度预算报告等数据源...<br><small style="color: #666;">支持CEO个性化认知、决策习惯分析，提供决策建议、风险预警、任务派发</small>');
            
            document.querySelector('.input-area').focus();
            
            setTimeout(() => {
                addUserMessage('华科电子BG这个月利润情况怎么样？有什么需要我关注的？');
                
                setTimeout(() => {
                    // 显示澄清表单
                    const systemMsg = document.createElement('div');
                    systemMsg.className = 'message system';
                    systemMsg.innerHTML = '<div class="message-content"><p><strong>为了提供更精准的分析，请补充以下信息：</strong></p><div style="margin-top: 12px; background: #f8f9fc; border-radius: 12px; padding: 16px;"><form id="clarificationForm" style="display: flex; flex-direction: column; gap: 12px;"><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="font-weight: 500; margin-bottom: 8px; color: #1a73e8;">📋 分析维度选择</div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;"><label style="display: flex; align-items: center; font-size: 13px;"><input type="checkbox" checked style="margin-right: 6px;"> 利润结构分析</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="checkbox" checked style="margin-right: 6px;"> 成本控制情况</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="checkbox" checked style="margin-right: 6px;"> 人效对比</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="checkbox" style="margin-right: 6px;"> 客户结构分析</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="checkbox" style="margin-right: 6px;"> 市场竞争态势</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="checkbox" style="margin-right: 6px;"> 风险预警</label></div></div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="font-weight: 500; margin-bottom: 8px; color: #1a73e8;">⏰ 关注时间范围</div><div style="display: flex; gap: 8px;"><label style="display: flex; align-items: center; font-size: 13px;"><input type="radio" name="timeRange" value="current" checked style="margin-right: 6px;"> 当月情况</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="radio" name="timeRange" value="quarter" style="margin-right: 6px;"> 季度对比</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="radio" name="timeRange" value="year" style="margin-right: 6px;"> 年度趋势</label></div></div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="font-weight: 500; margin-bottom: 8px; color: #1a73e8;">🎯 决策目标</div><select style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;"><option value="optimization">优化现有业务</option><option value="expansion">业务扩张计划</option><option value="cost_control">成本控制重点</option><option value="risk_management">风险管理加强</option><option value="team_development">团队发展</option></select></div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="font-weight: 500; margin-bottom: 8px; color: #1a73e8;">📊 对比基准</div><div style="display: flex; gap: 8px;"><label style="display: flex; align-items: center; font-size: 13px;"><input type="radio" name="benchmark" value="budget" checked style="margin-right: 6px;"> 预算目标</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="radio" name="benchmark" value="history" style="margin-right: 6px;"> 历史同期</label><label style="display: flex; align-items: center; font-size: 13px;"><input type="radio" name="benchmark" value="peer" style="margin-right: 6px;"> 同业对比</label></div></div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="font-weight: 500; margin-bottom: 8px; color: #1a73e8;">💼 管理偏好</div><textarea placeholder="请描述您当前最关心的具体问题，如：担心某个成本项过高、关注特定客户续约情况等..." style="width: 100%; height: 60px; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; resize: vertical;"></textarea></div><div style="text-align: center; margin-top: 8px;"><button type="button" onclick="submitClarificationForm()" style="background: #1a73e8; color: white; border: none; padding: 10px 24px; border-radius: 6px; font-size: 14px; cursor: pointer;">🔍 开始深度分析</button></div></form></div></div>';
                    chatMessages.appendChild(systemMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 800);
            }, 1000);
        }
        
        // 处理澄清表单提交 - 添加进度条和知识库存储
        function submitClarificationForm() {
            const chatMessages = document.querySelector('.chat-messages');
            
            // 添加CEO填写表单的消息
            addUserMessage('已完成信息补充，请基于详细需求进行分析');
            
            // 显示分析进度
            setTimeout(() => {
                const progressMsg = document.createElement('div');
                progressMsg.className = 'message system';
                progressMsg.innerHTML = '<div class="message-content"><div style="background: #f0f5ff; border-radius: 12px; padding: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 12px; display: flex; align-items: center;"><i class="ri-settings-3-line rotating" style="margin-right: 6px;"></i>正在深度分析华科电子BG数据...</div><div style="background: #fff; border-radius: 8px; padding: 12px; margin-bottom: 12px;"><div id="analysisProgress" style="font-size: 13px; color: #666;"></div><div style="width: 100%; height: 8px; background: #f1f1f1; border-radius: 4px; margin-top: 8px; overflow: hidden;"><div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #1a73e8, #4285f4); transition: width 0.3s ease;"></div></div></div><div style="font-size: 12px; color: #999; text-align: center;">• 融合资金日报、经营月报数据<br>• 结合您的决策偏好进行个性化分析<br>• 生成专业决策建议和风险预警</div></div></div>';
                chatMessages.appendChild(progressMsg);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // 模拟分析进度
                const progressSteps = [
                    { text: '正在获取华科电子BG实时数据...', progress: 20 },
                    { text: '正在分析利润结构和成本控制情况...', progress: 40 },
                    { text: '正在进行人效对比和预算目标分析...', progress: 60 },
                    { text: '正在生成风险预警和决策建议...', progress: 80 },
                    { text: '正在整合分析结果...', progress: 100 }
                ];
                
                let currentStep = 0;
                const progressInterval = setInterval(() => {
                    if (currentStep < progressSteps.length) {
                        document.getElementById('analysisProgress').textContent = progressSteps[currentStep].text;
                        document.getElementById('progressBar').style.width = progressSteps[currentStep].progress + '%';
                        currentStep++;
                    } else {
                        clearInterval(progressInterval);
                        
                        // 移除进度消息
                        setTimeout(() => {
                            chatMessages.removeChild(progressMsg);
                            
                            // 显示分析结果
                            const systemMsg = document.createElement('div');
                            systemMsg.className = 'message system';
                            systemMsg.innerHTML = '<div class="message-content"><p><strong>华科电子BG 深度经营洞察分析</strong></p><div style="margin-top: 12px; background: #f8f9fc; border-radius: 12px; padding: 16px;"><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-pie-chart-line" style="margin-right: 6px;"></i>基于您的需求定制分析</div><div style="background: #fff; border-radius: 8px; padding: 12px; font-size: 12px;"><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;"><div><span style="color: #34C759;">✅</span> 利润结构已分析</div><div><span style="color: #34C759;">✅</span> 成本控制已核查</div><div><span style="color: #34C759;">✅</span> 人效对比已完成</div><div><span style="color: #34C759;">✅</span> 预算目标已对比</div></div><div style="font-size: 11px; color: #666; text-align: center; background: #f8f9fc; padding: 4px; border-radius: 4px;">已按您关注的"利润率>25%"和"人效持续改善"要求进行重点分析</div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-organization-chart" style="margin-right: 6px;"></i>阿米巴单元利润穿透</div><div style="background: #fff; border-radius: 8px; padding: 12px;"><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 12px;"><div style="background: #e8f5e9; border-radius: 8px; padding: 10px; text-align: center; border-left: 3px solid #34C759;"><div style="font-size: 16px; font-weight: 600; color: #34C759;">777万</div><div style="font-size: 11px; color: #666; margin: 2px 0;">本月营收</div><div style="font-size: 10px; color: #34C759;">↗ +15.2%</div></div><div style="background: #fff3e0; border-radius: 8px; padding: 10px; text-align: center; border-left: 3px solid #FF9800;"><div style="font-size: 16px; font-weight: 600; color: #FF9800;">568万</div><div style="font-size: 11px; color: #666; margin: 2px 0;">运营成本</div><div style="font-size: 10px; color: #FF9800;">↗ +8.3%</div></div><div style="background: #e8f1ff; border-radius: 8px; padding: 10px; text-align: center; border-left: 3px solid #007AFF;"><div style="font-size: 16px; font-weight: 600; color: #007AFF;">209万</div><div style="font-size: 11px; color: #666; margin: 2px 0;">净利润</div><div style="font-size: 10px; color: #007AFF;">↗ +28.7%</div></div></div><div style="background: #f8f9fc; border-radius: 6px; padding: 8px;"><div style="font-size: 12px; font-weight: 500; margin-bottom: 6px; color: #333;">责任人业绩穿透：</div><div style="font-size: 11px; color: #666; margin-bottom: 3px;"><span style="font-weight: 500;">于志国（总负责人）</span>：单元利润率26.9%，超额完成KPI</div><div style="font-size: 11px; color: #666; margin-bottom: 3px;"><span style="font-weight: 500;">吕吉林（销售负责）</span>：新签客户3家，回款及时率98%</div><div style="font-size: 11px; color: #666;"><span style="font-weight: 500;">技术团队</span>：人效同比提升12%，成本控制良好</div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #27ae60; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-lightbulb-line" style="margin-right: 6px;"></i>基于您决策偏好的建议</div><div style="background: #e8f5e9; border-radius: 8px; padding: 12px;"><div style="margin-bottom: 10px;"><div style="font-weight: 500; margin-bottom: 4px; color: #27ae60; font-size: 14px;">💡 核心决策建议</div><div style="font-size: 13px; color: #333; margin-bottom: 6px;"><strong>1. 利润分配优化</strong>：建议将超额利润的30%用于技术研发投入，70%作为团队激励</div><div style="font-size: 13px; color: #333; margin-bottom: 6px;"><strong>2. 人效提升策略</strong>：当前人效已达行业优秀水平，建议复制成功经验到其他BG</div><div style="font-size: 13px; color: #333;"><strong>3. 成本控制重点</strong>：重点关注您提到的技术研发成本，建议建立精细化预算管理</div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #e67e22; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-alarm-warning-line" style="margin-right: 6px;"></i>智能风险预警</div><div style="background: #fff3e0; border-radius: 8px; padding: 12px;"><div style="margin-bottom: 8px;"><div style="display: flex; align-items: center; margin-bottom: 4px;"><div style="width: 16px; height: 16px; border-radius: 8px; background: #FF9800; margin-right: 6px;"></div><div style="font-weight: 500; font-size: 13px;">中度风险</div><div style="margin-left: auto; font-size: 11px; color: #666;">影响评级: B</div></div><div style="font-size: 12px; color: #666; margin-bottom: 6px;"><strong>客户集中度过高</strong>：前3大客户占收入72%，存在依赖风险</div><div style="font-size: 12px; color: #666;"><strong>建议</strong>：Q4制定客户多元化策略，目标降至60%以下</div></div><div><div style="display: flex; align-items: center; margin-bottom: 4px;"><div style="width: 16px; height: 16px; border-radius: 8px; background: #34C759; margin-right: 6px;"></div><div style="font-weight: 500; font-size: 13px;">低度风险</div><div style="margin-left: auto; font-size: 11px; color: #666;">影响评级: A</div></div><div style="font-size: 12px; color: #666; margin-bottom: 6px;"><strong>技术人员流失率</strong>：目前3%，低于行业平均水平</div><div style="font-size: 12px; color: #666;"><strong>维持策略</strong>：继续保持现有激励机制</div></div></div></div></div></div><p style="margin-top: 12px;"><strong>分析完成！</strong>系统正在将分析报告存入知识库...</p></div>';
                    chatMessages.appendChild(systemMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // 显示报告存储进度
                    setTimeout(() => {
                        const saveMsg = document.createElement('div');
                        saveMsg.className = 'message system';
                        saveMsg.innerHTML = '<div class="message-content"><div style="background: #e8f5e9; border-radius: 12px; padding: 12px; border-left: 4px solid #34C759;"><div style="display: flex; align-items: center; margin-bottom: 8px;"><i class="ri-database-2-line" style="color: #34C759; margin-right: 6px;"></i><div style="font-weight: 500; color: #34C759;">报告已成功存入知识库</div></div><div style="font-size: 12px; color: #666; margin-bottom: 8px;"><strong>存储位置：</strong>/知识库/经营分析报告/华科电子BG/2024年9月深度分析.pdf</div><div style="font-size: 12px; color: #666; margin-bottom: 8px;"><strong>报告编号：</strong>EA-HK-20240925-001</div><div style="font-size: 12px; color: #666;"><strong>可用于：</strong>未来决策参考、团队汇报、投资方展示</div></div></div>';
                        chatMessages.appendChild(saveMsg);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                        
                        // 显示任务生成确认
                        setTimeout(() => {
                            const confirmMsg = document.createElement('div');
                            confirmMsg.className = 'message system';
                            confirmMsg.innerHTML = '<div class="message-content"><div style="background: #f0f5ff; border-radius: 12px; padding: 16px; border-left: 4px solid #1a73e8;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-question-line" style="margin-right: 6px;"></i>是否生成执行任务？</div><div style="font-size: 13px; color: #666; margin-bottom: 12px;">基于分析结果，系统建议生成以下执行任务并同步到任务决策智能体：</div><div style="background: #fff; border-radius: 8px; padding: 12px; margin-bottom: 12px;"><div style="font-size: 13px; font-weight: 500; margin-bottom: 8px; color: #333;">拟生成任务清单：</div><div style="font-size: 12px; color: #666; margin-bottom: 4px;">• 制定客户多元化拓展计划（高优先级）</div><div style="font-size: 12px; color: #666; margin-bottom: 4px;">• 复制成功管理经验到其他BG（中优先级）</div><div style="font-size: 12px; color: #666; margin-bottom: 4px;">• 设计超额利润分配方案（中优先级）</div><div style="font-size: 12px; color: #666;">• 建立精细化预算管理制度（低优先级）</div></div><div style="display: flex; gap: 12px; justify-content: center;"><button onclick="confirmTaskGeneration(true)" style="background: #1a73e8; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-size: 13px; cursor: pointer; flex: 1;">✅ 确认生成任务</button><button onclick="confirmTaskGeneration(false)" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-size: 13px; cursor: pointer; flex: 1;">❌ 暂不生成</button></div></div></div>';
                            chatMessages.appendChild(confirmMsg);
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                        }, 1500);
                    }, 2000);
                }, 500);
            }
        }, 1000); // 每秒更新一次进度
    }, 500);
}

// 新增：任务生成确认函数
function confirmTaskGeneration(confirmed) {
    const chatMessages = document.querySelector('.chat-messages');
    
    if (confirmed) {
        addUserMessage('确认生成任务，请同步到任务决策智能体');
        
        setTimeout(() => {
            const systemMsg = document.createElement('div');
            systemMsg.className = 'message system';
            systemMsg.innerHTML = '<div class="message-content"><div style="background: #f3e5f5; border-radius: 12px; padding: 16px;"><div style="font-weight: 500; color: #9C27B0; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-task-line" style="margin-right: 6px;"></i>任务已生成并同步</div><div style="font-size: 12px; color: #666; margin-bottom: 8px;">✅ 已成功同步至任务决策智能体，具体任务如下：</div><div style="margin-bottom: 8px;"><div style="background: #fff; border-radius: 6px; padding: 8px; margin-bottom: 6px; border-left: 3px solid #9C27B0;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;"><div style="font-weight: 500; font-size: 13px;">制定客户多元化拓展计划</div><div style="background: #9C27B0; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">高优</div></div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>负责人：</strong> 于志国、吕吉林</div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>截止时间：</strong> 2024年10月30日</div><div style="font-size: 11px; color: #666;"><strong>目标：</strong> 制定未来6个月客户拓展策略，降低前3大客户占比至60%</div></div><div style="background: #fff; border-radius: 6px; padding: 8px; margin-bottom: 6px; border-left: 3px solid #34C759;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;"><div style="font-weight: 500; font-size: 13px;">复制成功管理经验到其他BG</div><div style="background: #34C759; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">中优</div></div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>负责人：</strong> 于志国、HR部门</div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>截止时间：</strong> 2024年11月15日</div><div style="font-size: 11px; color: #666;"><strong>目标：</strong> 整理华科电子BG管理经验，在全集团推广实施</div></div><div style="background: #fff; border-radius: 6px; padding: 8px; border-left: 3px solid #FF9800;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;"><div style="font-weight: 500; font-size: 13px;">设计超额利润分配方案</div><div style="background: #FF9800; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">中优</div></div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>负责人：</strong> 财务部、于志国</div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>截止时间：</strong> 2024年10月25日</div><div style="font-size: 11px; color: #666;"><strong>目标：</strong> 制定59万超额利润的分配方案（30%研发，70%激励）</div></div></div><div style="text-align: center; margin-top: 8px;"><div style="display: inline-block; background: #9C27B0; color: white; padding: 6px 12px; border-radius: 6px; font-size: 11px; cursor: pointer;">📋 跳转到任务决策智能体</div></div></div><p style="margin-top: 12px;">任务已成功生成，您可以在任务决策智能体中查看详细进度和管理任务执行。</p></div>';
            chatMessages.appendChild(systemMsg);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }, 800);
    } else {
        addUserMessage('暂不生成任务，我再考虑一下');
        
        setTimeout(() => {
            addSystemMessage('理解您的谨慎态度。分析报告已保存在知识库中，您随时可以要求基于此报告生成任务。现在继续为您分析其他业务单元。');
        }, 800);
    }
}

// 处理第二个澄清表单提交 - 同样添加进度条
function submitClarificationForm2() {
    const chatMessages = document.querySelector('.chat-messages');
    
    addUserMessage('已完成紧急情况信息补充，请立即分析');
    
    // 显示紧急分析进度
    setTimeout(() => {
        const progressMsg = document.createElement('div');
        progressMsg.className = 'message system';
        progressMsg.innerHTML = '<div class="message-content"><div style="background: #ffebee; border-radius: 12px; padding: 16px; border-left: 4px solid #e74c3c;"><div style="font-weight: 500; color: #e74c3c; margin-bottom: 12px; display: flex; align-items: center;"><i class="ri-alarm-warning-line rotating" style="margin-right: 6px;"></i>🚨 紧急分析猎豹交通BG数据...</div><div style="background: #fff; border-radius: 8px; padding: 12px; margin-bottom: 12px;"><div id="emergencyProgress" style="font-size: 13px; color: #666;"></div><div style="width: 100%; height: 8px; background: #f1f1f1; border-radius: 4px; margin-top: 8px; overflow: hidden;"><div id="emergencyProgressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #e74c3c, #ff6b9d); transition: width 0.3s ease;"></div></div></div><div style="font-size: 12px; color: #999; text-align: center;">• 实时现金流监控分析<br>• 应收账款风险评估<br>• 紧急救援方案制定</div></div></div>';
        chatMessages.appendChild(progressMsg);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        
        // 紧急分析进度
        const emergencySteps = [
            { text: '正在获取猎豹交通BG实时现金流数据...', progress: 25 },
            { text: '正在分析应收账款和成本结构...', progress: 50 },
            { text: '正在评估团队稳定性和客户风险...', progress: 75 },
            { text: '正在制定紧急救援方案...', progress: 100 }
        ];
        
        let currentStep = 0;
        const emergencyInterval = setInterval(() => {
            if (currentStep < emergencySteps.length) {
                document.getElementById('emergencyProgress').textContent = emergencySteps[currentStep].text;
                document.getElementById('emergencyProgressBar').style.width = emergencySteps[currentStep].progress + '%';
                currentStep++;
            } else {
                clearInterval(emergencyInterval);
                
                // 移除进度消息并显示结果
                setTimeout(() => {
                    chatMessages.removeChild(progressMsg);
                    
                    const systemMsg = document.createElement('div');
                    systemMsg.className = 'message system';
                    systemMsg.innerHTML = '<div class="message-content"><p><strong>猎豹交通BG 紧急现金流分析</strong></p><div style="margin-top: 12px; background: #f8f9fc; border-radius: 12px; padding: 16px;"><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #e74c3c; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-alarm-warning-line" style="margin-right: 6px;"></i>⚠️ 现金流预警状态</div><div style="background: #ffebee; border-radius: 8px; padding: 12px; border-left: 4px solid #e74c3c;"><div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 12px;"><div style="background: #fff; border-radius: 8px; padding: 10px; text-align: center; border-left: 3px solid #e74c3c;"><div style="font-size: 16px; font-weight: 600; color: #e74c3c;">390万</div><div style="font-size: 11px; color: #666; margin: 2px 0;">现金余额</div><div style="font-size: 10px; color: #e74c3c;">⚠️ 预警线</div></div><div style="background: #fff; border-radius: 8px; padding: 10px; text-align: center; border-left: 3px solid #FF9800;"><div style="font-size: 16px; font-weight: 600; color: #FF9800;">0万</div><div style="font-size: 11px; color: #666; margin: 2px 0;">可用资金</div><div style="font-size: 10px; color: #e74c3c;">🚨 危险</div></div><div style="background: #fff; border-radius: 8px; padding: 10px; text-align: center; border-left: 3px solid #34C759;"><div style="font-size: 16px; font-weight: 600; color: #34C759;">168万</div><div style="font-size: 11px; color: #666; margin: 2px 0;">本月回款</div><div style="font-size: 10px; color: #34C759;">↗ 正常</div></div></div></div></div><div style="margin-bottom: 16px;"><div style="font-weight: 500; color: #27ae60; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-lightbulb-line" style="margin-right: 6px;"></i>基于您风险偏好的救援方案</div><div style="background: #fff3e0; border-radius: 8px; padding: 12px; border-left: 4px solid #FF9800;"><div style="margin-bottom: 10px;"><div style="font-weight: 500; margin-bottom: 4px; color: #e74c3c; font-size: 14px;">🚨 7天内紧急救援措施</div><div style="font-size: 13px; color: #333; margin-bottom: 6px;"><strong>1. 立即资金注入</strong>：从华科电子BG调配300万应急资金</div><div style="font-size: 13px; color: #333; margin-bottom: 6px;"><strong>2. 团队重组</strong>：更换运营团队负责人，借调管理人员</div><div style="font-size: 13px; color: #333;"><strong>3. 应收账款催收</strong>：启动专项催收，目标回收200万</div></div><div style="font-size: 12px; color: #666; background: #f8f9fc; padding: 8px; border-radius: 6px;"><strong>风险控制</strong>：考虑到您500万损失上限，建议分阶段投入，先投300万观察1个月效果</div></div></div></div></div><p style="margin-top: 12px;"><strong>紧急分析完成！</strong>系统正在将紧急分析报告存入知识库...</p></div>';
                    chatMessages.appendChild(systemMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // 显示报告存储和任务确认
                    setTimeout(() => {
                        const saveMsg = document.createElement('div');
                        saveMsg.className = 'message system';
                        saveMsg.innerHTML = '<div class="message-content"><div style="background: #ffebee; border-radius: 12px; padding: 12px; border-left: 4px solid #e74c3c;"><div style="display: flex; align-items: center; margin-bottom: 8px;"><i class="ri-database-2-line" style="color: #e74c3c; margin-right: 6px;"></i><div style="font-weight: 500; color: #e74c3c;">🚨 紧急报告已存入知识库</div></div><div style="font-size: 12px; color: #666; margin-bottom: 8px;"><strong>存储位置：</strong>/知识库/紧急分析报告/猎豹交通BG/现金流危机分析.pdf</div><div style="font-size: 12px; color: #666; margin-bottom: 8px;"><strong>报告编号：</strong>EA-LB-EMERGENCY-20240925-001</div><div style="font-size: 12px; color: #666;"><strong>紧急级别：</strong>特级预警</div></div><div style="background: #f0f5ff; border-radius: 8px; padding: 12px; margin-top: 12px; border-left: 4px solid #1a73e8;"><div style="font-weight: 500; color: #1a73e8; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-question-line" style="margin-right: 6px;"></i>是否立即生成紧急救援任务？</div><div style="font-size: 13px; color: #666; margin-bottom: 12px;">基于紧急分析，强烈建议立即生成救援任务：</div><div style="background: #fff; border-radius: 6px; padding: 10px; margin-bottom: 8px;"><div style="font-size: 13px; font-weight: 500; margin-bottom: 4px;">紧急任务清单：</div><div style="font-size: 12px; color: #666; margin-bottom: 3px;">• 紧急资金调配（今日完成）</div><div style="font-size: 12px; color: #666; margin-bottom: 3px;">• 管理团队调整（3日内）</div><div style="font-size: 12px; color: #666; margin-bottom: 3px;">• 应收账款专项催收（7日内）</div><div style="font-size: 12px; color: #666;">• CEO客户挽回行动（10日内）</div></div><div style="display: flex; gap: 8px; justify-content: center;"><button onclick="confirmEmergencyTasks(true)" style="background: #e74c3c; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 12px; cursor: pointer;">🚨 立即生成紧急任务</button><button onclick="confirmEmergencyTasks(false)" style="background: #666; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 12px; cursor: pointer;">❌ 暂缓处理</button></div></div></div>';
                        chatMessages.appendChild(saveMsg);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 2000);
                }, 500);
            }
        }, 1250); // 稍快一些的紧急分析进度
    }, 500);
}

// 新增：紧急任务确认函数
function confirmEmergencyTasks(confirmed) {
    const chatMessages = document.querySelector('.chat-messages');
    
    if (confirmed) {
        addUserMessage('立即生成紧急任务，同步到任务决策智能体');
        
        setTimeout(() => {
            const systemMsg = document.createElement('div');
            systemMsg.className = 'message system';
            systemMsg.innerHTML = '<div class="message-content"><div style="background: #ffebee; border-radius: 12px; padding: 16px; border-left: 4px solid #e74c3c;"><div style="font-weight: 500; color: #e74c3c; margin-bottom: 8px; display: flex; align-items: center;"><i class="ri-alarm-warning-line" style="margin-right: 6px;"></i>🚨 紧急任务已生成</div><div style="font-size: 12px; color: #666; margin-bottom: 8px;">已紧急同步至任务决策智能体，所有任务已标记为最高优先级：</div><div style="margin-bottom: 8px;"><div style="background: #fff; border-radius: 6px; padding: 8px; margin-bottom: 6px; border-left: 3px solid #e74c3c; border: 2px solid #e74c3c;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;"><div style="font-weight: 500; font-size: 13px;">紧急资金调配</div><div style="background: #e74c3c; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">🚨 特急</div></div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>负责人：</strong> CFO财务总监</div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>截止时间：</strong> 2024年9月25日 18:00（今日）</div><div style="font-size: 11px; color: #666;"><strong>目标：</strong> 从集团资金池调配300万至猎豹交通BG</div></div><div style="background: #fff; border-radius: 6px; padding: 8px; margin-bottom: 6px; border-left: 3px solid #e74c3c;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;"><div style="font-weight: 500; font-size: 13px;">管理团队调整</div><div style="background: #e74c3c; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">特急</div></div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>负责人：</strong> HR总监、于志国</div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>截止时间：</strong> 2024年9月28日</div><div style="font-size: 11px; color: #666;"><strong>目标：</strong> 委派华科电子优秀管理人员支援重组</div></div><div style="background: #fff; border-radius: 6px; padding: 8px; margin-bottom: 6px; border-left: 3px solid #FF9800;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;"><div style="font-weight: 500; font-size: 13px;">应收账款专项催收</div><div style="background: #FF9800; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">紧急</div></div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>负责人：</strong> 李建国、法务部</div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>截止时间：</strong> 2024年10月2日</div><div style="font-size: 11px; color: #666;"><strong>目标：</strong> 回收200万应收账款，改善现金流</div></div><div style="background: #fff; border-radius: 6px; padding: 8px; border-left: 3px solid #9C27B0;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;"><div style="font-weight: 500; font-size: 13px;">CEO客户挽回行动</div><div style="background: #9C27B0; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">高优</div></div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>负责人：</strong> CEO亲自、李建国协助</div><div style="font-size: 11px; color: #666; margin-bottom: 4px;"><strong>截止时间：</strong> 2024年10月5日</div><div style="font-size: 11px; color: #666;"><strong>目标：</strong> 挽回2家流失客户，签署新合作协议</div></div></div><div style="text-align: center; margin-top: 8px;"><div style="display: inline-block; background: #e74c3c; color: white; padding: 6px 12px; border-radius: 6px; font-size: 11px; cursor: pointer;">🚨 立即查看紧急任务</div></div></div><p style="margin-top: 12px;">紧急任务已创建，任务决策智能体将实时监控执行进度。建议您保持密切关注，如有需要可随时调整策略。</p></div>';
            chatMessages.appendChild(systemMsg);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }, 800);
    } else {
        addUserMessage('我再考虑一下，暂缓生成任务');
        
        setTimeout(() => {
            addSystemMessage('理解您的谨慎态度。紧急分析报告已保存在知识库中，我会持续监控猎豹交通BG的现金流状况，如情况恶化会及时预警。您随时可以要求生成紧急任务。');
        }, 800);
    }
}

// 添加系统消息的辅助函数
function addSystemMessage(text) {
    const chatMessages = document.querySelector('.chat-messages');
    const systemMsg = document.createElement('div');
    systemMsg.className = 'message system';
    systemMsg.innerHTML = '<div class="message-content">' + text + '</div>';
    chatMessages.appendChild(systemMsg);
    chatMessages.scrollTop = chatMessages.scrollHeight;
    return systemMsg;
}

// 添加用户消息的辅助函数
function addUserMessage(text) {
    const chatMessages = document.querySelector('.chat-messages');
    const userMsg = document.createElement('div');
    userMsg.className = 'message user';
    userMsg.innerHTML = '<div class="message-content">' + text + '</div>';
    chatMessages.appendChild(userMsg);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Scene switcher functionality
const sceneSwitcher = document.querySelector('.scene-switcher');
let sceneDropdown;

sceneSwitcher.addEventListener('click', function(e) {
    e.stopPropagation();
    
    // Create dropdown if it doesn't exist
    if (!sceneDropdown) {
        sceneDropdown = document.createElement('div');
        sceneDropdown.className = 'scene-dropdown';
        sceneDropdown.innerHTML = `
            <div class="scene-option">通用场景</div>
            <div class="scene-option">任务决策</div>
            <div class="scene-option active">经营决策</div>
            <div class="scene-option">战略决策</div>
        `;
        document.querySelector('.chat-input-container').appendChild(sceneDropdown);
        
        // Position the dropdown properly
        const rect = sceneSwitcher.getBoundingClientRect();
        sceneDropdown.style.position = 'absolute';
        sceneDropdown.style.bottom = '65px';
        sceneDropdown.style.left = '10px';
        
        // Add click events to options
        const sceneOptions = sceneDropdown.querySelectorAll('.scene-option');
        sceneOptions.forEach(option => {
            option.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Check which scene is clicked and redirect accordingly
                if (this.textContent === '通用场景') {
                    window.location.href = 'chat.html';
                    return;
                } else if (this.textContent === '任务决策') {
                    window.location.href = 'task_agent.html';
                    return;
                } else if (this.textContent === '战略决策') {
                    window.location.href = 'strategy_agent.html';
                    return;
                }
                
                // Update active state for 经营决策 (stay on current page)
                sceneOptions.forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                
                // Update scene switcher text
                sceneSwitcher.querySelector('span').textContent = this.textContent;
                
                // Hide dropdown
                sceneDropdown.style.display = 'none';
            });
        });
    }
    
    // Toggle dropdown visibility
    if (getComputedStyle(sceneDropdown).display !== 'none') {
        sceneDropdown.style.display = 'none';
    } else {
        sceneDropdown.style.display = 'block';
    }
});

// Network toggle functionality
const networkToggle = document.querySelector('.network-toggle');
networkToggle.addEventListener('click', function() {
    this.classList.toggle('active');
    if (this.classList.contains('active')) {
        this.querySelector('span').textContent = '联网';
    } else {
        this.querySelector('span').textContent = '不联网';
    }
});

// Hide scene dropdown when clicking elsewhere
document.addEventListener('click', function(e) {
    if (sceneDropdown && sceneDropdown.style.display === 'block' && !sceneSwitcher.contains(e.target) && !sceneDropdown.contains(e.target)) {
        sceneDropdown.style.display = 'none';
    }
});
    </script>
</body>
</html> 